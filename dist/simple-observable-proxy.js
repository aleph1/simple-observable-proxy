const e=new WeakSet,r=new WeakMap,t=new Set,o=()=>{t.forEach((e=>{e.observers.forEach((e=>e()))})),t.clear(),window.requestAnimationFrame(o)};class s{constructor(o,n){if(e.has(o))throw new Error("Can’t observe Observable.proxy");const a=this,c=new Proxy(o,{get:(e,r)=>e[r],set(e,o,s){if(e[o]!==s){if(a.proxy){if(r.has(s))throw new Error("Can’t nest observables");t.add(n||a)}e[o]=s}return!0},deleteProperty:(e,r)=>r in e&&(delete e[r],t.add(n||a),!0)});(Array.isArray(o)?[...Array(o.length).keys()]:Object.keys(o)).forEach((e=>{const t=o[e];if(r.has(t))throw new Error("Can’t nest observables");(Array.isArray(t)||"object"==typeof t&&t instanceof Object)&&(c[e]=new s(t,a).proxy)})),a.observers=new Set,r.set(a.proxy=c,a),e.add(a.data=o)}observe(e){return this.observers.add(e)}unobserve(e){return this.observers.delete(e)}destroy(){return this.observers=this.observers.clear(),e.delete(this.data)&&r.delete(this.proxy)}}export function observable(e){return(Array.isArray(e)||"object"==typeof e&&e instanceof Object)&&new s(e).proxy}export function observe(e,t){const o=r.get(e);return!(!o||"function"!=typeof t)&&o.observe(t)}export function unobserve(e,t){const o=r.get(e);return!(!o||"function"!=typeof t)&&o.unobserve(t)}export function destroy(e){const t=r.get(e);return!!t&&t.destroy()}o();